# 特征构建和预处理结果摘要

## 处理概述
根据 `stock_105_AAPL_columns_explanation.md` 文档，成功对AAPL和VGT数据进行了特征构建和预处理。

## 处理结果

### 1. AAPL数据 (stock_105.AAPL_2025-09.csv)
- **原始数据**: 2,535行 × 32列
- **处理后数据**: 2,535行 × 32列
- **输出文件**: `Data/processed_stock_105.AAPL_2025-09.csv`

### 2. VGT数据 (etf_VGT_2025-09.csv)
- **原始数据**: 2,535行 × 11列
- **处理后数据**: 2,535行 × 32列
- **输出文件**: `Data/processed_etf_VGT_2025-09.csv`

## 特征构建详情

### 基础特征 (已计算)
1. **turnover** - 成交额 (volume × close)
2. **amplitude** - 振幅 ((high - low) / close) × 100
3. **pct_change** - 涨跌幅 ((close - open) / open) × 100
4. **change_amount** - 涨跌额 (close - open)
5. **turnover_rate** - 换手率 (估算值)

### 技术指标 (已计算)
1. **移动平均线指标**:
   - SMA_20 (20日简单移动平均线)
   - SMA_50 (50日简单移动平均线)
   - EMA_12 (12日指数移动平均线)
   - EMA_26 (26日指数移动平均线)
   - EMA_50 (50日指数移动平均线)

2. **MACD指标**:
   - MACD (MACD线)
   - MACD_Signal (MACD信号线)
   - MACD_Histogram (MACD柱状图)

3. **动量指标**:
   - RSI (相对强弱指数)

4. **布林带指标**:
   - BB_Upper (布林带上轨)
   - BB_Middle (布林带中轨)
   - BB_Lower (布林带下轨)

5. **随机振荡器**:
   - Stoch_K (随机振荡器K值)
   - Stoch_D (随机振荡器D值)

6. **威廉指标**:
   - Williams_R (威廉%R指标)

7. **波动率指标**:
   - ATR (平均真实波幅)

8. **成交量指标**:
   - Volume_SMA (成交量20日移动平均线)

9. **价格变化指标**:
   - Price_Change (日价格变化率)
   - Price_Change_5d (5日价格变化率)
   - Price_Change_10d (10日价格变化率)
   - Volatility_20d (20日波动率)

## 空值处理

### 空值分布
两个数据集中共有690个空值，分布如下：
- **turnover_rate**: 251个空值 (换手率估算导致)
- **SMA_20**: 19个空值 (前19天无法计算)
- **SMA_50**: 49个空值 (前49天无法计算)
- **EMA_12**: 11个空值 (前11天无法计算)
- **EMA_26**: 25个空值 (前25天无法计算)
- **EMA_50**: 49个空值 (前49天无法计算)
- **MACD系列**: 33个空值 (需要EMA_26计算)
- **RSI**: 14个空值 (前14天无法计算)
- **布林带系列**: 19个空值 (需要SMA_20计算)
- **随机振荡器**: 17个空值 (前14天无法计算)
- **威廉指标**: 13个空值 (前14天无法计算)
- **ATR**: 14个空值 (前14天无法计算)
- **Volume_SMA**: 19个空值 (前19天无法计算)
- **Price_Change**: 1个空值 (第一天无法计算)
- **Price_Change_5d**: 5个空值 (前5天无法计算)
- **Price_Change_10d**: 10个空值 (前10天无法计算)
- **Volatility_20d**: 20个空值 (前20天无法计算)

### 空值处理方式
- 所有空值已填充为字符串 "null"
- 使用 `na_filter=False` 参数读取CSV文件以防止pandas将"null"字符串转换为NaN

## 数据质量

### 数据类型
- **object**: 23列 (包含"null"字符串的列)
- **float64**: 8列 (数值型数据)
- **int64**: 1列 (volume列)

### 数据完整性
- 两个数据集现在具有完全相同的列结构 (32列)
- 所有列名与AAPL文档中的定义一致
- 空值处理符合要求

## 使用建议

1. **读取数据时**: 使用 `pd.read_csv(file_path, na_filter=False)` 以防止"null"字符串被转换为NaN
2. **数据分析时**: 将"null"字符串转换为NaN或适当处理
3. **技术指标**: 前几行的空值是正常的，因为需要足够的历史数据来计算指标
4. **换手率**: 当前使用估算值，实际应用中需要真实的流通股本数据

## 文件位置
- 处理脚本: `feature_engineering.py`
- AAPL处理后数据: `Data/processed_stock_105.AAPL_2025-09.csv`
- VGT处理后数据: `Data/processed_etf_VGT_2025-09.csv`

---
**处理完成时间**: 2025年
**使用库**: pandas, numpy, TA-Lib
**处理状态**: ✅ 完成
